"use strict";(self.webpackChunkendless=self.webpackChunkendless||[]).push([[3625],{13625:function(t,e,i){i.r(e),i.d(e,{TasksModule:function(){return Xt}});var s=i(38583),n=i(49690),l=i(90217),a=i(65925),o=i(15483),r=i(58920),c=i(75690),d=i(63301),u=i(70453),g=i(72214),h=i(81946),p=i(10743),f=i(93184),Z=i(72533),_=i(3679),m=i(39895),A=i(91647),x=i(49962),v=i.n(x),T=i(65206),b=i(29022),q=i(88259),S=i.n(q),y=i(37716),E=i(75208),w=i(59543),U=i(12664),k=i(32579),M=i(39075),C=i(41365),N=i(86640),D=i(29790);function J(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",69),y.BQk()),2&t){const t=y.oxw();y.xp6(1),y.s9C("alt",t.user.name)}}function W(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",70),y.BQk()),2&t){const t=y.oxw();y.xp6(1),y.s9C("alt",t.user.name),y.Q6J("src",t.baseFolder+"/"+t.user.avatar,y.LSH)}}function O(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",72),y.BQk()),2&t){const t=y.oxw().$implicit,e=y.oxw();y.xp6(1),y.s9C("alt",t.name),y.Q6J("src",e.baseFolder+"/"+t.avatar,y.LSH)("ngbTooltip",t.name)}}function R(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",73),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.s9C("alt",t.name),y.Q6J("ngbTooltip",t.name)}}function L(t,e){if(1&t&&(y.TgZ(0,"li",71),y.YNc(1,O,2,3,"ng-container",10),y.YNc(2,R,2,2,"ng-container",10),y.qZA()),2&t){const t=e.$implicit;y.xp6(1),y.Q6J("ngIf",null!=t.avatar),y.xp6(1),y.Q6J("ngIf",null==t.avatar)}}function I(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",72),y.BQk()),2&t){const t=y.oxw().$implicit,e=y.oxw(2);y.xp6(1),y.s9C("alt",t.name),y.Q6J("src",e.baseFolder+"/"+t.avatar,y.LSH)("ngbTooltip",t.name)}}function Q(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",73),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.s9C("alt",t.name),y.Q6J("ngbTooltip",t.name)}}function F(t,e){if(1&t&&(y.TgZ(0,"li",71),y.YNc(1,I,2,3,"ng-container",10),y.YNc(2,Q,2,2,"ng-container",10),y.qZA()),2&t){const t=e.$implicit;y.xp6(1),y.Q6J("ngIf",null!=t.avatar),y.xp6(1),y.Q6J("ngIf",null==t.avatar)}}function Y(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"p"),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"div",13),y.TgZ(5,"ul"),y.YNc(6,F,3,2,"li",14),y.qZA(),y.qZA(),y.BQk()),2&t){const t=y.oxw();y.xp6(2),y.hij("",y.lcZ(3,2,"Followers"),":"),y.xp6(4),y.Q6J("ngForOf",t.ccList)}}function G(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"a",74),y.NdJ("click",function(){y.CHM(t);const e=y.oxw();return e.closeTask(e.entity)}),y._UZ(1,"i",75),y._uU(2),y.ALo(3,"translate"),y.ALo(4,"translate"),y.qZA()}2&t&&(y.xp6(2),y.AsE(" ",y.lcZ(3,2,"Close")," ",y.lcZ(4,4,"Task")," "))}function j(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li",21),y.NdJ("click",function(){return y.CHM(t),y.oxw()._createNew()}),y.TgZ(1,"a",22),y.TgZ(2,"span",23),y._UZ(3,"i",30),y._uU(4),y.ALo(5,"translate"),y.qZA(),y.qZA(),y.qZA()}2&t&&(y.xp6(4),y.hij(" ",y.lcZ(5,1,"Create new"),""))}function P(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li",26),y.NdJ("click",function(){y.CHM(t);const e=y.oxw();return e.getUserEmail(e.type="trash")}),y.TgZ(1,"a",27),y.TgZ(2,"span",23),y._UZ(3,"i",76),y._uU(4),y.ALo(5,"translate"),y.qZA(),y.TgZ(6,"span",25),y._uU(7),y.qZA(),y.qZA(),y.qZA()}if(2&t){const t=y.oxw();y.xp6(4),y.hij(" ",y.lcZ(5,2,"Trash"),""),y.xp6(3),y.hij("(",t.getUserEmail("trash").length,")")}}function H(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",81),y.BQk()),2&t){const t=y.oxw().$implicit,e=y.oxw();y.xp6(1),y.s9C("alt",t.name),y.Q6J("src",e.baseFolder+"/"+t.avatar,y.LSH)}}function B(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",82),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.s9C("alt",t.name)}}function z(t,e){1&t&&y._UZ(0,"img",83)}function $(t,e){if(1&t){const t=y.EpF();y.ynx(0),y._uU(1," | "),y.TgZ(2,"a",84),y.NdJ("click",function(){y.CHM(t);const e=y.oxw().$implicit;return y.oxw()._editComposer(e)}),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.BQk()}2&t&&(y.xp6(3),y.Oqu(y.lcZ(4,1,"Edit")))}function K(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"a",27),y.TgZ(1,"div",8),y.TgZ(2,"div",77),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw().selectedUserEmail(e)}),y.YNc(3,H,2,2,"ng-container",10),y.YNc(4,B,2,1,"ng-container",10),y.qZA(),y.TgZ(5,"div",31),y.TgZ(6,"h6"),y.TgZ(7,"span",26),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw().selectedUserEmail(e)}),y._uU(8),y.qZA(),y.TgZ(9,"small",26),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw().selectedUserEmail(e)}),y._uU(10,"("),y.TgZ(11,"span",78),y._uU(12),y.ALo(13,"date"),y.qZA(),y._uU(14,") "),y.YNc(15,z,1,0,"img",79),y.YNc(16,$,5,3,"ng-container",10),y.qZA(),y.qZA(),y.TgZ(17,"p"),y.TgZ(18,"span",80),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw().selectedUserEmail(e)}),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA()}if(2&t){const t=e.$implicit,i=y.oxw();y.xp6(3),y.Q6J("ngIf",null!=t.avatar),y.xp6(1),y.Q6J("ngIf",null==t.avatar),y.xp6(1),y.Q6J("ngClass",2==t.type?"media-body jignore":"media-body"),y.xp6(3),y.hij("",t.title," "),y.xp6(4),y.Oqu(y.xi3(13,8,t.timestamp,"dd/MM/yyyy HH:mm")),y.xp6(3),y.Q6J("ngIf",t.is_active),y.xp6(1),y.Q6J("ngIf",!t.is_active&&i.user.id==t.created_by),y.xp6(2),y.Q6J("innerHtml",t.content,y.oJD)}}function V(t,e){1&t&&(y.ynx(0),y.TgZ(1,"div",85),y.TgZ(2,"div",86),y._UZ(3,"img",87),y.TgZ(4,"p",49),y._uU(5),y.ALo(6,"translate"),y.qZA(),y.qZA(),y.qZA(),y.BQk()),2&t&&(y.xp6(5),y.Oqu(y.lcZ(6,1,"Not found items")))}function X(t,e){1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"translate"),y.BQk()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Send")))}function tt(t,e){1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"translate"),y.BQk()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Loading")))}function et(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",55),y.TgZ(1,"label",88),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"ng-select",89),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw().follow_users=e}),y.ALo(5,"translate"),y.ALo(6,"translate"),y.qZA(),y.qZA()}if(2&t){const t=y.oxw();y.xp6(2),y.Oqu(y.lcZ(3,9,"Followers")),y.xp6(2),y.Q6J("items",t._users)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("bindLabel","name")("ngModel",t.follow_users)("placeholder",y.lcZ(5,11,"Please choose"))("notFoundText",y.lcZ(6,13,"Not found item"))}}function it(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",82),y.BQk()),2&t){const t=y.oxw(2);y.xp6(1),y.s9C("alt",null==t.selectEmail?null:t.selectEmail.name)}}function st(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",102),y.BQk()),2&t){const t=y.oxw(2);y.xp6(1),y.Q6J("src",t.baseFolder+"/"+(null==t.selectEmail?null:t.selectEmail.avatar),y.LSH)}}function nt(t,e){if(1&t&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&t){const t=e.$implicit;y.xp6(1),y.hij("",t.name,", ")}}function lt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li",111),y.TgZ(1,"img",112),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw(3)._downloadFileResult(e)}),y.qZA(),y.qZA()}}function at(t,e){if(1&t&&(y.ynx(0),y.TgZ(1,"div",71),y.TgZ(2,"h6",103),y._UZ(3,"i",104),y._uU(4),y.ALo(5,"translate"),y.qZA(),y.TgZ(6,"a",105),y._UZ(7,"i",106),y._uU(8),y.ALo(9,"translate"),y.qZA(),y._UZ(10,"div",107),y.qZA(),y.TgZ(11,"div",108),y.TgZ(12,"ul",109),y.YNc(13,lt,2,0,"li",110),y.qZA(),y.qZA(),y._UZ(14,"hr"),y.BQk()),2&t){const t=y.oxw(2);y.xp6(4),y.hij(" ",y.lcZ(5,3,"Attachment")," "),y.xp6(4),y.Oqu(y.lcZ(9,5,"All")),y.xp6(5),y.Q6J("ngForOf",null==t.selectEmail?null:t.selectEmail.urls.data)}}function ot(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li"),y.TgZ(1,"a",113),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2);return e.flagReply=!e.flagReply}),y._UZ(2,"i",114),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.qZA()}2&t&&(y.xp6(3),y.Oqu(y.lcZ(4,1,"Reply")))}function rt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li"),y.TgZ(1,"a",113),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2);return e.selectedmail(null,e.selectEmail)}),y._UZ(2,"i",115),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.qZA()}2&t&&(y.xp6(3),y.Oqu(y.lcZ(4,1,"Complete")))}function ct(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li"),y.TgZ(1,"a",113),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2);return e.updateType(e.selectEmail,2)}),y._UZ(2,"i",116),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.qZA()}2&t&&(y.xp6(3),y.Oqu(y.lcZ(4,1,"Delete")))}function dt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li"),y.TgZ(1,"a",113),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2);return e.updateType(e.selectEmail,null)}),y._UZ(2,"i",117),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.qZA()}2&t&&(y.xp6(3),y.Oqu(y.lcZ(4,1,"Recall")))}function ut(t,e){1&t&&y._UZ(0,"i",128)}function gt(t,e){1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"translate"),y.BQk()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Processing")))}function ht(t,e){if(1&t){const t=y.EpF();y.ynx(0),y._UZ(1,"hr"),y.TgZ(2,"div",2),y.TgZ(3,"div",118),y.TgZ(4,"div",55),y.TgZ(5,"div",119),y.TgZ(6,"input",120),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw(2).entitySubDID.content=e}),y.ALo(7,"translate"),y.qZA(),y.TgZ(8,"div",121),y.TgZ(9,"span",122),y._UZ(10,"i",123),y.TgZ(11,"input",124,125),y.NdJ("change",function(e){y.CHM(t);const i=y.MAs(12);return y.oxw(2).fileEvent1(e,i)}),y.qZA(),y.qZA(),y.TgZ(13,"span",126),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2);return e.isSaveComment?null:e.submitComment(e.selectEmail)}),y.YNc(14,ut,1,0,"i",127),y.YNc(15,gt,3,3,"ng-container",10),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.BQk()}if(2&t){const t=y.oxw(2);y.xp6(6),y.s9C("placeholder",y.lcZ(7,4,"Comment")),y.Q6J("ngModel",t.entitySubDID.content),y.xp6(8),y.Q6J("ngIf",!t.isSaveComment),y.xp6(1),y.Q6J("ngIf",t.isSaveComment)}}function pt(t,e){1&t&&y._UZ(0,"hr")}function ft(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"li",111),y.TgZ(1,"img",112),y.NdJ("click",function(){const e=y.CHM(t).$implicit;return y.oxw(4)._downloadFileResult(e)}),y.qZA(),y.qZA()}}const Zt=function(){return[]};function _t(t,e){if(1&t&&(y.TgZ(0,"tr"),y.TgZ(1,"td"),y._uU(2),y.qZA(),y.TgZ(3,"td"),y.TgZ(4,"div",108),y.TgZ(5,"ul",109),y.YNc(6,ft,2,0,"li",110),y.qZA(),y.qZA(),y.qZA(),y.TgZ(7,"td"),y._uU(8),y.qZA(),y.TgZ(9,"td"),y._uU(10),y.ALo(11,"date"),y.qZA(),y.qZA()),2&t){const t=e.$implicit;y.xp6(2),y.Oqu(t.content),y.xp6(4),y.Q6J("ngForOf",null==t.urls?y.DdM(7,Zt):t.urls.data),y.xp6(2),y.Oqu(t.name),y.xp6(2),y.hij(" ",y.xi3(11,4,t.timestamp,"dd/MM/yyyy h:mm a")," ")}}function mt(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.YNc(1,pt,1,0,"hr",10),y.TgZ(2,"div",2),y.TgZ(3,"div",118),y.TgZ(4,"div",129),y.TgZ(5,"table",130),y.TgZ(6,"thead"),y.TgZ(7,"th"),y._uU(8),y.ALo(9,"translate"),y.qZA(),y.TgZ(10,"th"),y._uU(11),y.ALo(12,"translate"),y.qZA(),y.TgZ(13,"th"),y._uU(14),y.ALo(15,"translate"),y.qZA(),y.TgZ(16,"th"),y._uU(17),y.ALo(18,"translate"),y.qZA(),y.qZA(),y.TgZ(19,"tbody"),y.YNc(20,_t,12,8,"tr",94),y.qZA(),y.qZA(),y.qZA(),y.TgZ(21,"div",131),y.TgZ(22,"div",132),y.TgZ(23,"pagination",133),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw(2).pageIndex=e})("pageChanged",function(e){return y.CHM(t),y.oxw(2).pageChanged(e)}),y.qZA(),y.qZA(),y.TgZ(24,"div",134),y.TgZ(25,"a",135),y._uU(26),y.ALo(27,"translate"),y.ALo(28,"translate"),y.ALo(29,"translate"),y.ALo(30,"translate"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.BQk()}if(2&t){const t=y.oxw(2);y.xp6(1),y.Q6J("ngIf",!t.selectEmail.is_active),y.xp6(7),y.Oqu(y.lcZ(9,18,"Content")),y.xp6(3),y.Oqu(y.lcZ(12,20,"Attachment")),y.xp6(3),y.Oqu(y.lcZ(15,22,"Created by")),y.xp6(3),y.Oqu(y.lcZ(18,24,"CreatedDate")),y.xp6(3),y.Q6J("ngForOf",t._children),y.xp6(3),y.Q6J("boundaryLinks",!0)("totalItems",t.totalRow)("ngModel",t.pageIndex)("maxSize",t.pageDisplay)("itemsPerPage",t.pageSize),y.xp6(3),y.Q0o("",y.lcZ(27,26,"Total of records"),": ",t.totalRow," - ",y.lcZ(28,28,"Page")," ",t.pageIndex," ",y.lcZ(29,30,"of")," ",t.totalPage," ",y.lcZ(30,32,"page"),"")}}const At=function(t){return{"active show":t}};function xt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",90),y.TgZ(1,"div",91),y.TgZ(2,"div",36),y.TgZ(3,"div",2),y.TgZ(4,"div",92),y.TgZ(5,"div",8),y.YNc(6,it,2,1,"ng-container",10),y.YNc(7,st,2,1,"ng-container",10),y.TgZ(8,"div",11),y.TgZ(9,"h6"),y._uU(10),y.TgZ(11,"small"),y.TgZ(12,"span",78),y._uU(13),y.ALo(14,"date"),y.qZA(),y.TgZ(15,"span",78),y._uU(16),y.ALo(17,"date"),y.qZA(),y._uU(18),y.ALo(19,"date"),y.TgZ(20,"i",93),y.NdJ("click",function(){y.CHM(t);const e=y.oxw();return e.updateType(e.selectEmail,1)}),y.qZA(),y.qZA(),y.qZA(),y.TgZ(21,"p"),y.YNc(22,nt,2,1,"span",94),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(23,"div",95),y.TgZ(24,"div",96),y.TgZ(25,"p",97),y._uU(26),y.qZA(),y.TgZ(27,"i",98),y.NdJ("click",function(){y.CHM(t);const e=y.oxw();return e.addFavourite(e.selectEmail)}),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(28,"div",53),y._UZ(29,"p",99),y._UZ(30,"hr"),y.YNc(31,at,15,7,"ng-container",10),y.TgZ(32,"div",100),y.TgZ(33,"ul",101),y.YNc(34,ot,5,3,"li",10),y.YNc(35,rt,5,3,"li",10),y.YNc(36,ct,5,3,"li",10),y.YNc(37,dt,5,3,"li",10),y.qZA(),y.qZA(),y.YNc(38,ht,16,6,"ng-container",10),y.YNc(39,mt,31,34,"ng-container",10),y.qZA(),y.qZA(),y.qZA()}if(2&t){const t=y.oxw();y.Q6J("ngClass",y.VKq(29,At,!t.compose)),y.xp6(6),y.Q6J("ngIf",null==(null==t.selectEmail?null:t.selectEmail.avatar)),y.xp6(1),y.Q6J("ngIf",null!=(null==t.selectEmail?null:t.selectEmail.avatar)),y.xp6(3),y.hij(" ",null==t.selectEmail?null:t.selectEmail.title," "),y.xp6(3),y.hij("(",y.xi3(14,20,null==t.selectEmail?null:t.selectEmail.timestamp,"dd/MM/yyyy"),")"),y.xp6(3),y.hij(" ",y.xi3(17,23,null==t.selectEmail?null:t.selectEmail.timestamp,"h:mm"),""),y.xp6(2),y.hij(" ",y.xi3(19,26,null==t.selectEmail?null:t.selectEmail.timestamp,"a")," "),y.xp6(2),y.Q6J("ngClass",1==(null==t.selectEmail?null:t.selectEmail.type)?"icofont icofont-flag-alt-1 text-danger":"icofont icofont-flag-alt-1"),y.xp6(2),y.Q6J("ngForOf",null==t.selectEmail?null:t.selectEmail.cc),y.xp6(4),y.Oqu(null==t.selectEmail?null:t.selectEmail.email),y.xp6(1),y.ekj("starred",t._flagFav),y.xp6(2),y.Q6J("innerHTML",null==t.selectEmail?null:t.selectEmail.content,y.oJD),y.xp6(2),y.Q6J("ngIf",null!=(null==t.selectEmail?null:t.selectEmail.urls)),y.xp6(3),y.Q6J("ngIf",!t.selectEmail.is_active),y.xp6(1),y.Q6J("ngIf",2!=(null==t.selectEmail?null:t.selectEmail.type)&&!t.selectEmail.is_active),y.xp6(1),y.Q6J("ngIf",2!=(null==t.selectEmail?null:t.selectEmail.type)&&!t.selectEmail.is_active),y.xp6(1),y.Q6J("ngIf",2==(null==t.selectEmail?null:t.selectEmail.type)),y.xp6(1),y.Q6J("ngIf",t.flagReply),y.xp6(1),y.Q6J("ngIf",t._children.length>0)}}let vt=(()=>{class t{constructor(t,e,i,s,n,l,a,o,r,c,d){this._authenService=t,this._dataService=e,this._route=i,this._notifyService=s,this._uploadService=n,this._excelService=l,this._numberFormat=a,this.modalService=o,this._utilyService=r,this.sanitizer=c,this._activatedRoute=d,this._id="",this.entity={},this.entitySub={},this.baseFolder=T.h.BASE_API,this._users=[],this.follow_users=[],this.related_users=[],this.ccList=[],this.flagShow=!1,this.filesToUpload=[],this.isSave=!1,this.getlist=[],this.getlistAll=[],this.flagReply=!1,this.pageIndex=1,this.pageSize=10,this.pageDisplay=10,this.totalRow=0,this._children=[],this.entitySubDID={},this.filesToUpload1=[],this.isSaveComment=!1,this._flagFav=!1,this._flagAllowCC=!1,this._detailId="",this.compose=!0,this.allEmails=A.M.Emails,this.selectedEmails=[],this.socket=v()(T.h.BASE_API)}ngOnInit(){this.user=this._authenService.getLoggedInUser(),this._activatedRoute.params.subscribe(t=>{this._id=t.id,this.loadUsersWithDept(this._id),this.loadData(),this.socket.on("refreshPage",t=>{""!=this._detailId&&this.loadSubData(this._detailId)})})}loadUsersWithDept(t){let e={};e.short_code=this.user.short_code,this._dataService.post("/cat-submission/getallUsersNP",e).subscribe(e=>{this._dataService.post("/tasks/detailCount",{id:t,userid:this.user.id}).subscribe(t=>{this.entity=t.data,this.related_users=null==t.data.related_users?[]:t.data.related_users.data;let i=[];for(let e of t.data.related_users.data)e.id!=this.user.id&&i.push({id:e.id,name:e.name});let s=null==t.data.follow_users?[]:JSON.parse(t.data.follow_users);for(let l of s)if(this.user.id!=l){let t=e.data.filter(t=>t.id==l)[0];i.push({id:l,name:t.name})}let n=[];for(let l of s){this.user.id==l&&(this._flagAllowCC=!0,this.compose=!1);let t=e.data.filter(t=>t.id==l)[0];n.push({id:l,name:t.name,avatar:t.avatar})}1==t.data.is_active&&(this.compose=!1),this.ccList=n,this._users=i,this.socket.emit("refresh",{})})})}loadDetailByDID(t){console.log(t,this.compose),this._dataService.post("/tasks/detailByDID",{did:t}).subscribe(t=>{if(console.log("Detail",t),this.compose=!0,this.entitySub=t.data,t.data.cc.length>0){let e=[];for(let i of t.data.cc)e.push(i.id);this.follow_users=e,this.flagShow=!0}else this.follow_users=[],this.flagShow=!1})}fileEvent(t,e){this.filesToUpload=t.target.files,this._files=e}submit(){this.entitySub.follow_users=this.flagShow?JSON.stringify(this.follow_users):null,this.isSave=!0,this.entitySub.id=this._id,this.entitySub.parent_id=null,this.entitySub.created_by=this.user.id,null!=this.entitySub.did?(this.isSave=!1,0==this.filesToUpload.length?this._dataService.post("/tasks/updateDetail",this.entitySub).subscribe(t=>{this.isSave=!1,"failed"===t.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_UPDATENO_EN:b.W.MSG_UPDATENO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.entitySub={},this.entitySub.title=null,this.entitySub.content=null,this.follow_users=[],this.entitySub.follow_users=null,this.flagShow=!1,this.loadData(),this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"))},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}):this._processUploadDisagreeAfter(this.filesToUpload)):0==this.filesToUpload.length?this._dataService.post("/tasks/addDetail",this.entitySub).subscribe(t=>{this.isSave=!1,"failed"===t.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_ADDNO_EN:b.W.MSG_ADDNO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.entitySub={},this.entitySub.title=null,this.entitySub.content=null,this.follow_users=[],this.entitySub.follow_users=null,this.flagShow=!1,this.loadData(),this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_ADD_EN:b.W.MSG_ADD,"OK"))},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}):this._processUploadDisagreeAfter(this.filesToUpload)}_processUploadDisagreeAfter(t){let e={folder_name:"tasks"};e.id=this._id,this._uploadService.uploadFileMulti("/services/multi-uploads/"+e.id+"/"+e.folder_name,t).subscribe(t=>{this.entitySub.urls={data:t.data},console.log(this.entitySub,t),null==this.entitySub.id?this._dataService.post("/tasks/addDetail",this.entitySub).subscribe(t=>{this.isSave=!1,"failed"!=t.result&&(this._files.value=[],this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_ADD_EN:b.W.MSG_ADD,"OK"),this.socket.emit("refresh",{}))},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}):this._dataService.post("/tasks/updateDetail",this.entitySub).subscribe(t=>{this.isSave=!1,"failed"!=t.result&&(this._files.value=[],this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"),this.socket.emit("refresh",{}))},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}closeTask(t){S().fire({title:"en"==this.user.lang?b.W.are_you_sure_complete_en:b.W.are_you_sure_complete,text:t.title,icon:"warning",showCancelButton:!0,cancelButtonText:"en"==this.user.lang?b.W.cancel_en:b.W.cancel,confirmButtonText:"en"==this.user.lang?b.W.confirmtext_en:b.W.confirmtext}).then(e=>{if(e.value){let e={};e.id=t.id,e.stat=!0,this._dataService.post("/tasks/closeTask",e).subscribe(t=>{"failed"!=t.result?(this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"),this._route.navigate(["/tasks/requests"])):this._notifyService.showError("en"==this.user.lang?b.W.MSG_UPDATENO_EN:b.W.MSG_UPDATENO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}})}loadData(){this._dataService.post("/tasks/getalltaskdetail",{userid:this.user.id,id:this._id}).subscribe(t=>{this.getlist=t.data.filter(t=>2!=t.type),this.getlistAll=t.data})}getUserEmail(t){let e=[];if("allmail"==t)return e=this.getlist,e;if("favourite"==t){let t=[];for(let e of this.getlistAll.filter(t=>null!=t.favorites&&2!=t.type))e.favorites.data.filter(t=>t.id==this.user.id&&t.stat).length>0&&t.push(e);return e=t,e}return"trash"===t?e=this.getlistAll.filter(t=>2==t.type):"pending"===t?e=this.getlistAll.filter(t=>(null==t.is_active||0==t.is_active)&&2!=t.type):"important"===t?e=this.getlistAll.filter(t=>1==t.type):[]}selectedUserEmail(t){this.selectEmail=t,this.flagReply=!1,null!=this.selectEmail&&(this._flagFav=null!=this.selectEmail.favorites&&this.selectEmail.favorites.data.filter(t=>t.id==this.user.id&&t.stat).length>0),this.compose=!1,this._detailId=t.did,this.loadSubData(t.did)}selectedmail(t,e){S().fire({title:"en"==this.user.lang?b.W.are_you_sure_complete_en:b.W.are_you_sure_complete,text:e.title,icon:"warning",showCancelButton:!0,cancelButtonText:"en"==this.user.lang?b.W.cancel_en:b.W.cancel,confirmButtonText:"en"==this.user.lang?b.W.confirmtext_en:b.W.confirmtext}).then(t=>{if(t.value){let t={};t.did=e.did,t.stat=!0,this._dataService.post("/tasks/updateStatus",t).subscribe(t=>{this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"),this.selectEmail=t.data,this.loadUsersWithDept(this._id),this.loadData(),this.loadSubData(this._detailId)},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}})}moveEmails(t){!t||this.selectedEmails.filter(e=>e.type=t)}addFavourite(t){console.log(t),this.updateFavorite(t.did,!this._flagFav)}_downloadFileResult(t){window.open(T.h.BASE_API+"/"+t,"blank")}loadSubData(t){this._dataService.post("/tasks/getalltaskdetailbydid",{did:t,page:this.pageIndex,limit:this.pageSize}).subscribe(t=>{this._children=t.data,this.totalRow=t.rowCount,this.totalPage=t.totalPages})}pageChanged(t){this.pageIndex=t.page,this.loadSubData(this._detailId)}_createNew(){this.compose=!0,this.entitySub={},this.entitySub.did=null,this._children=[],this.follow_users=[],this.flagShow=!1}fileEvent1(t,e){this.filesToUpload1=t.target.files,this._files1=e}submitComment(t){this.isSaveComment=!0,this.entitySubDID.id=this._id,this.entitySubDID.parent_id=t.did,this.entitySubDID.created_by=this.user.id,this.entitySubDID.title="Re: "+t.title,0==this.filesToUpload1.length?this._dataService.post("/tasks/addDetail",this.entitySubDID).subscribe(t=>{this.isSaveComment=!1,this.flagReply=!1,"failed"===t.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_ADDNO_EN:b.W.MSG_ADDNO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.entitySubDID={},this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_ADD_EN:b.W.MSG_ADD,"OK"))},()=>{this.isSaveComment=!1,this.flagReply=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}):this._processUploadDisagreeAfter1(this.filesToUpload1,t.did)}_processUploadDisagreeAfter1(t,e){let i={folder_name:"tasks"};i.id=this._id,this._uploadService.uploadFileMulti("/services/multi-uploads/"+i.id+"/"+i.folder_name,t).subscribe(t=>{this.entitySubDID.urls={data:t.data},this._dataService.post("/tasks/addDetail",this.entitySubDID).subscribe(t=>{this.isSaveComment=!1,this.flagReply=!1,"failed"!=t.result&&(this._files1.value=[],this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_ADD_EN:b.W.MSG_ADD,"OK"),this.loadSubData(e))},()=>{this.isSaveComment=!1,this.flagReply=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})},()=>{this.isSaveComment=!1,this.flagReply=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}updateFavorite(t,e){let i={};i.did=t,i.stat=e,i.userid=this.user.id,this._dataService.post("/tasks/updateFavorite",i).subscribe(e=>{"failed"===e.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_UPDATENO_EN:b.W.MSG_UPDATENO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.compose=!0,this._children=[],this.selectEmail=e.data,this.loadData(),this.loadSubData(t),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"))},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}updateType(t,e){this.compose=!0,this._children=[];let i={};i.did=t.did,i.type=1==t.type?null:e,this._dataService.post("/tasks/updateTypes",i).subscribe(e=>{"failed"===e.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_UPDATENO_EN:b.W.MSG_UPDATENO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.loadUsersWithDept(this._id),this.loadData(),this.loadSubData(t.did),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"))},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}_editComposer(t){this.compose=!0,this.loadDetailByDID(t.did)}}return t.\u0275fac=function(e){return new(e||t)(y.Y36(o.e),y.Y36(a.D),y.Y36(m.F0),y.Y36(E.c),y.Y36(l.C),y.Y36(n.x),y.Y36(w.p),y.Y36(U.FF),y.Y36(k.t),y.Y36(M.H7),y.Y36(m.gz))},t.\u0275cmp=y.Xpm({type:t,selectors:[["app-task-detail"]],decls:137,vars:79,consts:[[1,"container-fluid"],[1,"email-wrap"],[1,"row"],[1,"col-xl-3","col-md-6"],[1,"email-left-aside"],[1,"card"],[1,"card-body"],[1,"email-app-sidebar"],[1,"media"],[1,"media-size-email"],[4,"ngIf"],[1,"media-body"],[1,"f-w-600"],[1,"customers","d-inline-block","avatar-group"],["class","d-inline-block",4,"ngFor","ngForOf"],["role","tablist",1,"nav","main-menu"],[1,"nav-item"],["routerLink","/tasks/requests","id","pills-darkhome-tab","data-toggle","pill","role","tab","aria-controls","pills-darkhome","aria-selected","true",1,"btn-primary","btn-block","btn-mail"],[1,"icofont","icofont-rounded-double-left","mr-2"],["href","javascript:;","class","btn-success btn-block btn-mail","id","pills-darkprofile-tab","data-toggle","pill","role","tab","aria-controls","pills-darkprofile","aria-selected","false",3,"click",4,"ngIf"],["class","nav-item",3,"click",4,"ngIf"],[1,"nav-item",3,"click"],["href","javascript:void(0)","id","pills-darkprofile-tab","data-toggle","pill","role","tab","aria-controls","pills-darkprofile","aria-selected","false",1,"show"],[1,"title"],[1,"icon-info-alt"],[1,"badge","pull-right","digits"],[3,"click"],["href","javascript:void(0)"],[1,"icon-star"],[1,"icon-folder"],[1,"icon-pencil-alt"],[3,"ngClass"],[3,"click",4,"ngIf"],[1,"email-right-aside"],[1,"card","email-body"],[1,"pr-0","b-r-light"],[1,"email-top"],[1,"col"],[1,"col","text-right"],[1,"inbox",2,"max-height","630px !important"],["href","javascript:void(0)",4,"ngFor","ngForOf"],[1,"col-xl-6","col-md-12"],[1,"card","email-body","radius-left"],[1,"pl-0"],[1,"tab-content"],["id","pills-darkhome","role","tabpanel","aria-labelledby","pills-darkhome-tab",1,"tab-pane","fade",3,"ngClass"],[1,"email-compose"],[1,"email-top","compose-border"],[1,"col-sm-8","xl-50"],[1,"mb-0"],[1,"col-sm-4","btn-middle","xl-50"],["type","button",1,"btn","btn-primary","btn-block","btn-mail","text-center","mb-0","mt-0",3,"click"],[1,"fa","fa-paper-plane","mr-2"],[1,"email-wrapper"],[1,"theme-form"],[1,"form-group"],["for","title"],[1,"text-danger"],["id","title","type","text","name","title","autocomplete","off","required","",1,"form-control",3,"ngModel","ngModelChange"],["for","chk-hidden",1,"d-block"],["id","chk-hidden","name","chk-hidden","type","checkbox",1,"checkbox_animated",3,"ngModel","ngModelChange"],["class","form-group",4,"ngIf"],[1,"form-group","mb-0"],["id","content",1,"text-muted"],["name","content","id","content","skin","moono-lisa","language","en",3,"ngModel","ngModelChange"],["for","filesToUpload",1,"col-form-label","pt-0"],["id","filesToUpload","name","filesToUpload","multiple","","type","file","accept",".pdf,.doc,.docx,.png,.jpg,jpeg",1,"form-control",3,"change"],["filesToUpload",""],["class","tab-pane fade","id","pills-darkprofile","role","tabpanel","aria-labelledby","pills-darkprofile-tab",3,"ngClass",4,"ngIf"],["src","../../../../assets/img/icon.png",1,"mr-3","rounded-circle","img-60",3,"alt"],[1,"mr-3","rounded-circle","img-60",3,"src","alt"],[1,"d-inline-block"],[1,"img-40","rounded-circle",3,"src","alt","ngbTooltip"],["src","../../../../assets/img/icon.png",1,"img-40","rounded-circle",3,"alt","ngbTooltip"],["href","javascript:;","id","pills-darkprofile-tab","data-toggle","pill","role","tab","aria-controls","pills-darkprofile","aria-selected","false",1,"btn-success","btn-block","btn-mail",3,"click"],[1,"icon-share","mr-2"],[1,"icon-trash"],[1,"media-size-email",3,"click"],[1,"digits"],["src","../../../../assets/img/icon-yes.svg",4,"ngIf"],[3,"innerHtml","click"],[1,"mr-3","rounded-circle","img-50",3,"src","alt"],["src","../../../../assets/img/icon.png",1,"mr-3","rounded-circle","img-50",3,"alt"],["src","../../../../assets/img/icon-yes.svg"],["href","javascript:;",1,"text-danger",3,"click"],[1,"search-not-found","text-center"],[1,""],["src","../../../../assets/images/search-not-found.png","alt","",1,"second-search"],["for","follower"],["name","_usersCc","bindValue","id","required","",3,"items","multiple","closeOnSelect","searchable","bindLabel","ngModel","placeholder","notFoundText","ngModelChange"],["id","pills-darkprofile","role","tabpanel","aria-labelledby","pills-darkprofile-tab",1,"tab-pane","fade",3,"ngClass"],[1,"email-content"],[1,"col-md-6","xl-100","col-sm-12"],[2,"cursor","pointer","font-size","16pt",3,"ngClass","click"],[4,"ngFor","ngForOf"],[1,"col-md-6","col-sm-12"],[1,"float-right","d-flex"],[1,"user-emailid"],[1,"fa","fa-star-o","f-18","mt-1",2,"cursor","pointer",3,"click"],[3,"innerHTML"],[1,"action-wrapper"],[1,"actions"],["alt","image",1,"mr-3","rounded-circle","img-50",3,"src"],[1,"text-muted"],[1,"icofont","icofont-clip"],["href","javascript:void(0)",1,"text-muted","text-right","right-download"],[1,"fa","fa-long-arrow-down","mr-2"],[1,"clearfix"],[1,"attachment"],[1,"list-inline"],["class","list-inline-item",4,"ngFor","ngForOf"],[1,"list-inline-item"],["src","../../../../assets/files/ico_file.png",1,"img-fluid",2,"width","20px","height","25px","cursor","pointer",3,"click"],["href","javascript:void(0)",1,"text-muted",3,"click"],[1,"fa","fa-reply","mr-2"],[1,"fa","fa-save","mr-2","text-success"],[1,"fa","fa-trash","text-danger","mr-2"],[1,"fa","fa-recycle","mr-2"],[1,"col-md-12"],[1,"input-group"],["type","text","aria-label","Recipient's username","name","comment",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"input-group-text","btn-file"],[1,"icofont","icofont-attachment"],["type","file","name","filesToUpload1","multiple","","type","file","accept",".pdf,.doc,.docx,.png,.jpg,jpeg",3,"change"],["filesToUpload1",""],[1,"input-group-text",3,"click"],["class","icofont icofont-save",4,"ngIf"],[1,"icofont","icofont-save"],[1,"table-responsive"],[1,"table","card-table","table-vcenter","text-nowrap"],[1,"form-inline"],[1,"col-sm-12","col-lg-12","col-xl-6"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb","name","paginationss1",1,"pagination-sm",3,"boundaryLinks","totalItems","ngModel","maxSize","itemsPerPage","ngModelChange","pageChanged"],[1,"col-sm-12","col-lg-12","col-xl-6",2,"text-align","right"],[1,"btn","btn-sm"]],template:function(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",0),y.TgZ(1,"div",1),y.TgZ(2,"div",2),y.TgZ(3,"div",3),y.TgZ(4,"div",4),y.TgZ(5,"div",5),y.TgZ(6,"div",6),y.TgZ(7,"div",7),y.TgZ(8,"div",8),y.TgZ(9,"div",9),y.YNc(10,J,2,1,"ng-container",10),y.YNc(11,W,2,2,"ng-container",10),y.qZA(),y.TgZ(12,"div",11),y.TgZ(13,"h6",12),y._uU(14),y.qZA(),y.TgZ(15,"p"),y._uU(16),y.qZA(),y.qZA(),y.qZA(),y.TgZ(17,"div",8),y.TgZ(18,"div",11),y.TgZ(19,"p"),y._uU(20),y.ALo(21,"translate"),y.qZA(),y.TgZ(22,"p"),y._uU(23),y.ALo(24,"translate"),y.qZA(),y.TgZ(25,"p"),y._uU(26),y.ALo(27,"translate"),y.qZA(),y.TgZ(28,"div",13),y.TgZ(29,"ul"),y.YNc(30,L,3,2,"li",14),y.qZA(),y.qZA(),y.YNc(31,Y,7,4,"ng-container",10),y.qZA(),y.qZA(),y.TgZ(32,"ul",15),y.TgZ(33,"li",16),y.TgZ(34,"a",17),y._UZ(35,"i",18),y._uU(36),y.ALo(37,"translate"),y.qZA(),y.YNc(38,G,5,6,"a",19),y.qZA(),y.TgZ(39,"li"),y._UZ(40,"hr"),y.qZA(),y.YNc(41,j,6,3,"li",20),y.TgZ(42,"li",21),y.NdJ("click",function(){return e.getUserEmail(e.type="important")}),y.TgZ(43,"a",22),y.TgZ(44,"span",23),y._UZ(45,"i",24),y._uU(46),y.ALo(47,"translate"),y.qZA(),y.TgZ(48,"span",25),y._uU(49),y.qZA(),y.qZA(),y.qZA(),y.TgZ(50,"li",26),y.NdJ("click",function(){return e.getUserEmail(e.type="favourite")}),y.TgZ(51,"a",27),y.TgZ(52,"span",23),y._UZ(53,"i",28),y._uU(54),y.ALo(55,"translate"),y.qZA(),y.TgZ(56,"span",25),y._uU(57),y.qZA(),y.qZA(),y.qZA(),y.TgZ(58,"li",26),y.NdJ("click",function(){return e.getUserEmail(e.type="allmail")}),y.TgZ(59,"a",27),y.TgZ(60,"span",23),y._UZ(61,"i",29),y._uU(62),y.ALo(63,"translate"),y.qZA(),y.TgZ(64,"span",25),y._uU(65),y.qZA(),y.qZA(),y.qZA(),y.TgZ(66,"li",26),y.NdJ("click",function(){return e.getUserEmail(e.type="pending")}),y.TgZ(67,"a",27),y.TgZ(68,"span",23),y._UZ(69,"i",30),y._uU(70),y.ALo(71,"translate"),y.qZA(),y.TgZ(72,"span",31),y._uU(73),y.qZA(),y.qZA(),y.qZA(),y.YNc(74,P,8,4,"li",32),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(75,"div",3),y.TgZ(76,"div",33),y.TgZ(77,"div",34),y.TgZ(78,"div",35),y.TgZ(79,"div",36),y.TgZ(80,"div",2),y.TgZ(81,"div",37),y.TgZ(82,"h5"),y._uU(83),y.ALo(84,"translate"),y.ALo(85,"titlecase"),y.qZA(),y.qZA(),y._UZ(86,"div",38),y.qZA(),y.qZA(),y.TgZ(87,"div",39),y.YNc(88,K,19,11,"a",40),y.ALo(89,"slice"),y.YNc(90,V,7,3,"ng-container",10),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(91,"div",41),y.TgZ(92,"div",33),y.TgZ(93,"div",42),y.TgZ(94,"div",43),y.TgZ(95,"div",44),y.TgZ(96,"div",45),y.TgZ(97,"div",46),y.TgZ(98,"div",47),y.TgZ(99,"div",2),y.TgZ(100,"div",48),y.TgZ(101,"h4",49),y._uU(102),y.ALo(103,"translate"),y.qZA(),y.qZA(),y.TgZ(104,"div",50),y.TgZ(105,"button",51),y.NdJ("click",function(){return e.isSave?null:e.submit()}),y._UZ(106,"i",52),y.YNc(107,X,3,3,"ng-container",10),y.YNc(108,tt,3,3,"ng-container",10),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(109,"div",53),y.TgZ(110,"form",54),y.TgZ(111,"div",55),y.TgZ(112,"label",56),y._uU(113),y.ALo(114,"translate"),y.TgZ(115,"span",57),y._uU(116,"*"),y.qZA(),y.qZA(),y.TgZ(117,"input",58),y.NdJ("ngModelChange",function(t){return e.entitySub.title=t}),y.qZA(),y.qZA(),y.TgZ(118,"div",55),y.TgZ(119,"label",59),y._uU(120),y.ALo(121,"translate"),y.ALo(122,"translate"),y.qZA(),y.TgZ(123,"input",60),y.NdJ("ngModelChange",function(t){return e.flagShow=t}),y.qZA(),y.qZA(),y.YNc(124,et,7,15,"div",61),y.TgZ(125,"div",62),y.TgZ(126,"label",63),y._uU(127),y.ALo(128,"translate"),y.qZA(),y.TgZ(129,"ck-editor",64),y.NdJ("ngModelChange",function(t){return e.entitySub.content=t}),y.qZA(),y.qZA(),y.TgZ(130,"div",55),y.TgZ(131,"label",65),y._uU(132),y.ALo(133,"translate"),y.qZA(),y.TgZ(134,"input",66,67),y.NdJ("change",function(i){y.CHM(t);const s=y.MAs(135);return e.fileEvent(i,s)}),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.YNc(136,xt,40,31,"div",68),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA()}2&t&&(y.xp6(10),y.Q6J("ngIf",null==e.user.avatar),y.xp6(1),y.Q6J("ngIf",null!=e.user.avatar),y.xp6(3),y.Oqu(e.user.name),y.xp6(2),y.Oqu(e.user.email),y.xp6(4),y.AsE("",y.lcZ(21,41,"Title"),": ",e.entity.title,""),y.xp6(3),y.AsE("",y.lcZ(24,43,"Content"),": ",e.entity.description,""),y.xp6(3),y.hij("",y.lcZ(27,45,"Assigned to"),":"),y.xp6(4),y.Q6J("ngForOf",e.related_users),y.xp6(1),y.Q6J("ngIf",e.ccList.length>0),y.xp6(5),y.hij(" ",y.lcZ(37,47,"Return")," "),y.xp6(2),y.Q6J("ngIf",0==e.entity.is_active),y.xp6(3),y.Q6J("ngIf",!e._flagAllowCC&&1!=e.entity.is_active),y.xp6(5),y.hij(" ",y.lcZ(47,49,"Important"),""),y.xp6(3),y.hij("(",e.getUserEmail("important").length,")"),y.xp6(5),y.hij(" ",y.lcZ(55,51,"Favourite"),""),y.xp6(3),y.hij("(",e.getUserEmail("favourite").length,")"),y.xp6(5),y.hij(" ",y.lcZ(63,53,"All"),""),y.xp6(3),y.hij("(",e.getUserEmail("allmail").length,")"),y.xp6(5),y.hij(" ",y.lcZ(71,55,"Pending"),""),y.xp6(2),y.Q6J("ngClass",0==e.getUserEmail("pending").length?"badge pull-right digits":"badge pull-right text-danger digits"),y.xp6(1),y.hij("(",e.getUserEmail("pending").length,")"),y.xp6(1),y.Q6J("ngIf",!e._flagAllowCC),y.xp6(9),y.hij(" ",y.lcZ(84,57,e.type?y.lcZ(85,59,"allmail"==e.type?"All":e.type):"All")," "),y.xp6(5),y.Q6J("ngForOf",y.Dn7(89,61,e.getUserEmail(e.type?e.type:"allmail"),0,7)),y.xp6(2),y.Q6J("ngIf",!e.getUserEmail(e.type?e.type:"allmail").length),y.xp6(6),y.Q6J("ngClass",y.VKq(77,At,e.compose)),y.xp6(6),y.Oqu(y.lcZ(103,65,"New message")),y.xp6(5),y.Q6J("ngIf",!e.isSave),y.xp6(1),y.Q6J("ngIf",e.isSave),y.xp6(5),y.hij("",y.lcZ(114,67,"Title")," "),y.xp6(4),y.Q6J("ngModel",e.entitySub.title),y.xp6(3),y.AsE(" ",y.lcZ(121,69,"Shown")," / ",y.lcZ(122,71,"Hidden"),"?"),y.xp6(3),y.Q6J("ngModel",e.flagShow),y.xp6(1),y.Q6J("ngIf",e.flagShow),y.xp6(3),y.Oqu(y.lcZ(128,73,"Description")),y.xp6(2),y.Q6J("ngModel",e.entitySub.content),y.xp6(3),y.Oqu(y.lcZ(133,75,"Attachment")),y.xp6(4),y.Q6J("ngIf",null!=e.selectEmail))},directives:[s.O5,s.sg,m.yS,s.mk,_._Y,_.JL,_.F,_.Fj,_.Q7,_.JJ,_.On,_.Wl,C.u,U._L,N.w9,g.Qt],pipes:[D.X$,s.rS,s.OU,s.uU],styles:[".btn-file[_ngcontent-%COMP%]{position:relative;overflow:hidden}.btn-file[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:absolute;top:0;right:0;text-align:right;opacity:0;outline:none;background:#fff;cursor:pointer;display:block}"]}),t})();var Tt=i(16738),bt=i(21388);function qt(t,e){1&t&&y._UZ(0,"img",31)}function St(t,e){1&t&&(y.ynx(0),y.TgZ(1,"tr"),y.TgZ(2,"td",32),y.TgZ(3,"h3",33),y._uU(4),y.ALo(5,"translate"),y.qZA(),y.qZA(),y.qZA(),y.BQk()),2&t&&(y.xp6(4),y.hij(" ",y.lcZ(5,1,"No records now!!!")," "))}function yt(t,e){if(1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"date"),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.Oqu(y.xi3(2,1,t.valid_date,"dd/MM/yyyy HH:mm"))}}function Et(t,e){1&t&&(y.ynx(0),y._uU(1),y.ALo(2,"translate"),y.BQk()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Indefinite")))}function wt(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",44),y.BQk()),2&t){const t=y.oxw().$implicit,e=y.oxw(2);y.xp6(1),y.s9C("alt",t.name),y.Q6J("src",e.baseFolder+"/"+t.avatar,y.LSH)("ngbTooltip",t.name)}}function Ut(t,e){if(1&t&&(y.ynx(0),y._UZ(1,"img",45),y.BQk()),2&t){const t=y.oxw().$implicit;y.xp6(1),y.s9C("alt",t.name),y.Q6J("ngbTooltip",t.name)}}function kt(t,e){if(1&t&&(y.TgZ(0,"li",43),y.YNc(1,wt,2,3,"ng-container",28),y.YNc(2,Ut,2,2,"ng-container",28),y.qZA()),2&t){const t=e.$implicit;y.xp6(1),y.Q6J("ngIf",null!=t.avatar),y.xp6(1),y.Q6J("ngIf",null==t.avatar)}}function Mt(t,e){1&t&&(y.TgZ(0,"span",46),y._uU(1),y.ALo(2,"translate"),y.qZA()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Opening")))}function Ct(t,e){1&t&&(y.TgZ(0,"span",47),y._uU(1),y.ALo(2,"translate"),y.qZA()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Completed")))}function Nt(t,e){1&t&&(y.TgZ(0,"span",48),y._uU(1),y.ALo(2,"translate"),y.qZA()),2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Cancel")))}function Dt(t,e){1&t&&y._UZ(0,"span")}function Jt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"button",52),y.NdJ("click",function(){y.CHM(t);const e=y.oxw(2).$implicit;return y.oxw().deleteItem(e)}),y.ALo(1,"translate"),y._UZ(2,"i",53),y.qZA()}2&t&&y.Q6J("ngbTooltip",y.lcZ(1,1,"Delete"))}function Wt(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.TgZ(1,"button",49),y.NdJ("click",function(){y.CHM(t);const e=y.oxw().$implicit,i=y.oxw(),s=y.MAs(81);return i._openModal(s,e)}),y.ALo(2,"translate"),y._UZ(3,"i",50),y.qZA(),y.YNc(4,Jt,3,3,"button",51),y.BQk()}if(2&t){const t=y.oxw().$implicit;y.xp6(1),y.Q6J("ngbTooltip",y.lcZ(2,2,"Edit")),y.xp6(3),y.Q6J("ngIf",0==t.is_active)}}function Ot(t,e){if(1&t){const t=y.EpF();y.ynx(0),y.TgZ(1,"tr"),y.TgZ(2,"td",27),y._uU(3),y.qZA(),y.TgZ(4,"td",27),y.TgZ(5,"a",34),y._uU(6),y.qZA(),y.qZA(),y.TgZ(7,"td",27),y.YNc(8,yt,3,4,"ng-container",28),y.YNc(9,Et,3,3,"ng-container",28),y.qZA(),y.TgZ(10,"td",27),y.TgZ(11,"div",35),y.TgZ(12,"ul"),y.YNc(13,kt,3,2,"li",36),y.qZA(),y.qZA(),y.qZA(),y.TgZ(14,"td",37),y.NdJ("click",function(){const e=y.CHM(t).$implicit,i=y.oxw();return 0==e.is_active?i._addReminder(e):null}),y._UZ(15,"i",38),y.ALo(16,"translate"),y.TgZ(17,"span",39),y._uU(18),y.qZA(),y.qZA(),y.TgZ(19,"td",27),y._uU(20),y.ALo(21,"translate"),y.qZA(),y.TgZ(22,"td",27),y.YNc(23,Mt,3,3,"span",40),y.YNc(24,Ct,3,3,"span",41),y.YNc(25,Nt,3,3,"span",42),y.qZA(),y.TgZ(26,"td"),y.YNc(27,Dt,1,0,"span",28),y.qZA(),y.TgZ(28,"td",27),y.YNc(29,Wt,5,4,"ng-container",28),y.qZA(),y.qZA(),y.BQk()}if(2&t){const t=e.$implicit,i=e.index,s=y.oxw();y.xp6(3),y.hij(" ",i+1," "),y.xp6(2),y.MGl("routerLink","/tasks/requests/detail/",t.id,""),y.xp6(1),y.Oqu(t.title),y.xp6(2),y.Q6J("ngIf",null!=t.valid_date),y.xp6(1),y.Q6J("ngIf",null==t.valid_date),y.xp6(4),y.Q6J("ngForOf",t.related_users.data),y.xp6(2),y.Q6J("ngbTooltip",y.lcZ(16,16,"Reminder")),y.xp6(3),y.Oqu(null==t.reminder?0:t.reminder),y.xp6(2),y.lnq(" ",y.lcZ(21,18,"Viewed")," (",t.count_view,"/",t.total_users,") "),y.xp6(3),y.Q6J("ngIf",0==t.is_active),y.xp6(1),y.Q6J("ngIf",1==t.is_active),y.xp6(1),y.Q6J("ngIf",2==t.is_active),y.xp6(2),y.Q6J("ngIf",1==t.is_active),y.xp6(2),y.Q6J("ngIf",t.created_by==s.user.id)}}function Rt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"a",76),y.NdJ("click",function(){return y.CHM(t),y.oxw(2).turnOnFlagCC()}),y._uU(1),y.ALo(2,"translate"),y.qZA()}2&t&&(y.xp6(1),y.Oqu(y.lcZ(2,1,"Cc")))}function Lt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",60),y.TgZ(1,"label",77),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"ng-select",78),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw(2).follow_users=e}),y.ALo(5,"translate"),y.ALo(6,"translate"),y.qZA(),y.qZA()}if(2&t){const t=y.oxw(2);y.xp6(2),y.Oqu(y.lcZ(3,10,"Followers")),y.xp6(2),y.Q6J("items",t._usersCc)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("bindLabel","name")("ngModel",t.follow_users)("placeholder",y.lcZ(5,12,"Please choose"))("notFoundText",y.lcZ(6,14,"Not found item"))("disabled",0!=t.entity.is_active)}}function It(t,e){1&t&&(y.ynx(0),y.TgZ(1,"a",79),y._UZ(2,"img",80),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.BQk()),2&t&&(y.xp6(3),y.hij(" ",y.lcZ(4,1,"Processing")," "))}function Qt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"button",82),y.NdJ("click",function(){return y.CHM(t),y.oxw(3).saveChange()}),y._uU(1),y.ALo(2,"translate"),y.qZA()}2&t&&(y.xp6(1),y.hij(" ",y.lcZ(2,1,"Save")," "))}function Ft(t,e){if(1&t&&(y.ynx(0),y.YNc(1,Qt,3,3,"button",81),y.BQk()),2&t){const t=y.oxw(2);y.xp6(1),y.Q6J("ngIf",!t.isSave)}}const Yt=function(){return{dateInputFormat:"DD-MM-YYYY HH:mm:ss",containerClass:"theme-dark-blue"}};function Gt(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",54),y.TgZ(1,"h4",55),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"button",56),y.NdJ("click",function(){return y.CHM(t).$implicit.dismiss("Cross click")}),y.TgZ(5,"span",57),y._uU(6,"\xd7"),y.qZA(),y.qZA(),y.qZA(),y.TgZ(7,"div",58),y.TgZ(8,"div",59),y.TgZ(9,"div",60),y.TgZ(10,"label",61),y._uU(11),y.ALo(12,"translate"),y.TgZ(13,"span",33),y._uU(14,"*"),y.qZA(),y.qZA(),y.TgZ(15,"input",62),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw().entity.title=e}),y.qZA(),y.qZA(),y.TgZ(16,"div",60),y.TgZ(17,"label",63),y._uU(18),y.ALo(19,"translate"),y.TgZ(20,"span",33),y._uU(21,"*"),y.qZA(),y.qZA(),y.TgZ(22,"textarea",64),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw().entity.description=e}),y.qZA(),y.qZA(),y.TgZ(23,"div",60),y.TgZ(24,"label",65),y._uU(25),y.ALo(26,"translate"),y.TgZ(27,"span",66),y._uU(28,"*"),y.qZA(),y.YNc(29,Rt,3,3,"a",67),y.qZA(),y.TgZ(30,"ng-select",68),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw().related_users=e})("change",function(){return y.CHM(t),y.oxw().changeUserCC()}),y.ALo(31,"translate"),y.ALo(32,"translate"),y.qZA(),y.qZA(),y.YNc(33,Lt,7,16,"div",69),y.TgZ(34,"div",60),y.TgZ(35,"label",70),y._uU(36),y.ALo(37,"translate"),y.qZA(),y.TgZ(38,"input",71),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw().jdate=e})("bsValueChange",function(e){return y.CHM(t),y.oxw().orgValueChange(e)}),y.ALo(39,"translate"),y.qZA(),y.qZA(),y.TgZ(40,"div",60),y.TgZ(41,"label",72),y._uU(42),y.ALo(43,"translate"),y.qZA(),y.TgZ(44,"nz-tree-select",73),y.NdJ("ngModelChange",function(e){return y.CHM(t),y.oxw()._parentIds=e}),y.ALo(45,"translate"),y.ALo(46,"translate"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(47,"div",74),y.TgZ(48,"button",75),y.NdJ("click",function(){return y.CHM(t).$implicit.dismiss("Cross click")}),y._uU(49),y.ALo(50,"translate"),y.qZA(),y.YNc(51,It,5,3,"ng-container",28),y.YNc(52,Ft,2,1,"ng-container",28),y.qZA()}if(2&t){const t=y.oxw();y.xp6(2),y.AsE(" ",y.lcZ(3,34,"ADD"==t._flagModal?"Add new":"Update")," ",t._title," "),y.xp6(9),y.hij("",y.lcZ(12,36,"Title")," "),y.xp6(4),y.Q6J("ngModel",t.entity.title)("disabled",0!=t.entity.is_active),y.xp6(3),y.hij("",y.lcZ(19,38,"Content")," "),y.xp6(4),y.Q6J("ngModel",t.entity.description)("disabled",0!=t.entity.is_active),y.xp6(3),y.hij("",y.lcZ(26,40,"Assigned to")," "),y.xp6(4),y.Q6J("ngIf",0==t.entity.is_active),y.xp6(1),y.Q6J("items",t._users)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("bindLabel","name")("ngModel",t.related_users)("placeholder",y.lcZ(31,42,"Please choose"))("notFoundText",y.lcZ(32,44,"Not found item"))("disabled",0!=t.entity.is_active),y.xp6(3),y.Q6J("ngIf",t.flagCc),y.xp6(3),y.Oqu(y.lcZ(37,46,"Valid date")),y.xp6(2),y.Q6J("placeholder",y.lcZ(39,48,"Indefinite"))("ngModel",t.jdate)("bsConfig",y.DdM(58,Yt))("disabled",0!=t.entity.is_active),y.xp6(4),y.Oqu(y.lcZ(43,50,"Related task")),y.xp6(2),y.s9C("nzPlaceHolder",y.lcZ(45,52,"Please choose")),y.s9C("nzNotFoundContent",y.lcZ(46,54,"Not found")),y.Q6J("ngModel",t._parentIds)("nzNodes",t._taskrelative)("disabled",0!=t.entity.is_active),y.xp6(5),y.hij(" ",y.lcZ(50,56,"Close")," "),y.xp6(2),y.Q6J("ngIf",t.isSave),y.xp6(1),y.Q6J("ngIf",0==t.entity.is_active)}}const jt=[{path:"",children:[{path:"requests",component:(()=>{class t{constructor(t,e,i,s,n,l,a,o,r,c){this._authenService=t,this._dataService=e,this._route=i,this._notifyService=s,this._uploadService=n,this._excelService=l,this._numberFormat=a,this.modalService=o,this._utilyService=r,this.sanitizer=c,this._keyword="",this.baseFolder=T.h.BASE_API,this._isLoading=!1,this.pageIndex=1,this.pageSize=25,this.pageDisplay=10,this.totalRow=0,this._requestslist=[],this._title="",this._flagModal="ADD",this.isSave=!1,this.entity={},this.related_users=[],this.follow_users=[],this._users=[],this._usersCc=[],this.jdate=null,this.flagCc=!1,this._taskrelative=[],this._parentIds=[],this.socket=v()(T.h.BASE_API)}ngOnInit(){this.user=this._authenService.getLoggedInUser(),this.loadData(),this.loadUsersWithDept(),this.socket.on("refreshPage",t=>{this.loadData()})}loadData(){this._isLoading=!0;let t={};t.page=this.pageIndex,t.limit=this.pageSize,t.filter=this._keyword,t.userid=this.user.id,this._dataService.post("/tasks/getall",t).subscribe(t=>{console.log("test",t);let e=[];for(let i of t.data){let t=i.related_users.data.filter(t=>t.is_view).length;i.count_view=t,i.total_users=i.related_users.data.length,e.push(i)}this._requestslist=e,this.totalRow=t.rowCount,this.totalPage=t.totalPages,this._isLoading=!1})}_pageSizeChange(t){this.pageSize=t.target.value,this.socket.emit("refresh",{})}pageChanged(t){this.pageIndex=t.page,this.socket.emit("refresh",{})}loadUsersWithDept(){let t={};t.short_code=this.user.short_code,this._dataService.post("/cat-submission/getallUsersNP",t).subscribe(t=>{console.log(t),this._users=t.data;let e=[];if(null!=this.entity.follow_users){for(let t of this._users)null!=this.entity.follow_users&&0==JSON.parse(this.entity.follow_users).filter(e=>e==t.id).length&&e.push(t);this._usersCc=e}else this._usersCc=this._users})}changeUserCC(){if(console.log("Before",this.related_users,this.follow_users),0==this.related_users.length)this.entity.related_users=null;else{let t=[],e=[];for(let i of this.related_users){let s=this._users.filter(t=>t.id==i)[0];t.push({id:i,name:s.name,avatar:s.avatar,is_view:!1}),e.push(i)}this.entity.related_users={data:t},this.entity.joined_users=0==e.length?null:JSON.stringify(e)}let t=[];for(let e of this._users)0==this.related_users.filter(t=>t==e.id).length&&t.push(e);this._usersCc=t}turnOnFlagCC(){if(this.flagCc=!this.flagCc,this.flagCc){let t=[];for(let e of this._users)0==this.related_users.filter(t=>t==e.id).length&&t.push(e);this._usersCc=t}}_openModal(t,e){null==e?(this._flagModal="ADD",this.entity={},this.entity.id=null,this.entity.title=null,this.entity.description=null,this.related_users=[],this.entity.related_users={data:[]},this.follow_users=[],this.jdate=null,this.entity.valid_date=null,this.entity.is_active=0,this.entity.created_by=this.user.id):(this._flagModal="UPDATE",this.loadDetailById(e.id)),this.modalService.open(t,{size:"md",centered:!0,backdrop:!1})}loadDetailById(t){this._dataService.post("/tasks/detail",{id:t}).subscribe(t=>{this.entity=t.data;let e=[];for(let i of t.data.related_users.data)e.push(i.id);if(this.related_users=e,null!=t.data.valid_date&&(this.jdate=new Date(t.data.valid_date),this.entity.valid_date=Tt(new Date(this.jdate)).format("DD/MM/YYYY HH:mm:ss")),null!=t.data.follow_users){this.flagCc=!0,this.follow_users=JSON.parse(t.data.follow_users);let e=[];for(let i of this._users)0==t.data.related_users.data.filter(t=>t.id==i.id).length&&e.push(i);this._usersCc=e}else this.flagCc=!1,this.follow_users=[]})}orgValueChange(t){null!=t&&"Invalid date"!=t?(this.jdate=t,this.entity.valid_date=Tt(this.jdate).format("YYYY-MM-DD HH:mm:ss")):(this.jdate=null,this.entity.valid_date=null)}saveChange(){this.entity.follow_users=0==this.follow_users.length?null:JSON.stringify(this.follow_users),this.isSave=!0,"ADD"==this._flagModal?this._dataService.post("/tasks/add",this.entity).subscribe(t=>{this.isSave=!1,"failed"===t.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_ADDNO_EN:b.W.MSG_ADDNO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_ADD_EN:b.W.MSG_ADD,"OK"),this.modalService.dismissAll())},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}):this._dataService.post("/tasks/update",this.entity).subscribe(t=>{this.isSave=!1,"failed"===t.result?this._notifyService.showError("en"==this.user.lang?b.W.MSG_UPDATENO_EN:b.W.MSG_UPDATENO,"en"==this.user.lang?b.W.error_title_en:b.W.error_title):(this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"),this.modalService.dismissAll())},()=>{this.isSave=!1,this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})}_addReminder(t){S().fire({title:"en"==this.user.lang?b.W.are_you_sure2send_en:b.W.are_you_sure2send,text:t.title,icon:"warning",showCancelButton:!0,cancelButtonText:"en"==this.user.lang?b.W.cancel_en:b.W.cancel,confirmButtonText:"en"==this.user.lang?b.W.confirmtext_en:b.W.confirmtext}).then(e=>{e.value&&this._dataService.post("/tasks/addReminder",{id:t.id}).subscribe(t=>{this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK"),this.socket.emit("refresh",{})},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)})})}deleteItem(t){S().fire({title:"en"==this.user.lang?b.W.are_you_sure_cancel_en:b.W.are_you_sure_cancel,text:t.title,icon:"warning",showCancelButton:!0,cancelButtonText:"en"==this.user.lang?b.W.cancel_en:b.W.cancel,confirmButtonText:"en"==this.user.lang?b.W.confirmtext_en:b.W.confirmtext}).then(e=>{e.value&&(t.is_active=2,this._dataService.post("/tasks/update",t).subscribe(t=>{this.socket.emit("refresh",{}),this._notifyService.showSuccess("en"==this.user.lang?b.W.MSG_UPDATE_EN:b.W.MSG_UPDATE,"OK")},()=>{this._notifyService.showError("en"==this.user.lang?b.W.MSG_ERROR_EN:b.W.MSG_ERROR,"en"==this.user.lang?b.W.error_title_en:b.W.error_title)}))})}loadTaskRelative(){let t={};t.userid=this.user.id,this._dataService.post("/tasks/getallrelative",t).subscribe(t=>{let e=[];for(let s of t.data)this.entity.id!=s.id&&e.push({key:s.id,title:s.title,parent_id:null,value:s.id});let i=this._utilyService.UnflattenFunc(e);this._taskrelative=i})}}return t.\u0275fac=function(e){return new(e||t)(y.Y36(o.e),y.Y36(a.D),y.Y36(m.F0),y.Y36(E.c),y.Y36(l.C),y.Y36(n.x),y.Y36(w.p),y.Y36(U.FF),y.Y36(k.t),y.Y36(M.H7))},t.\u0275cmp=y.Xpm({type:t,selectors:[["app-task-request"]],decls:82,vars:75,consts:[[1,"container-fluid"],[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"card-header"],[1,"col-sm-12","col-lg-12","col-xl-8"],[1,"col-md-12","form-inline"],["type","search","name","keyword","autocomplete","off",1,"form-control","form-control-sm","mr-sm-2",3,"placeholder","ngModel","ngModelChange","change","keyup.enter"],[1,"btn","btn-sm","btn-info","mr-sm-2",3,"click"],["src","../../../../assets/img/loading.gif","width","25px",4,"ngIf"],[1,"col-sm-12","col-lg-12","col-xl-4"],[1,"form-inline",2,"float","right"],["id","select3","name","select3",1,"form-control","form-control-sm","mr-sm-2",3,"ngModel","ngModelChange","change"],["value","10"],["value","25"],["value","50"],["value","100"],[1,"card-body"],[1,"col-sm-12","col-lg-12","col-xl-12"],[1,"form-inline"],[1,"col-sm-12","col-lg-12","col-xl-6"],["previousText","\u2039","nextText","\u203a","firstText","\xab","lastText","\xbb","name","paginationss1",1,"pagination-sm",3,"boundaryLinks","totalItems","ngModel","maxSize","itemsPerPage","ngModelChange","pageChanged"],[1,"col-sm-12","col-lg-12","col-xl-6",2,"text-align","right"],[1,"btn","btn-sm"],[1,"table-responsive"],["id","hor-minimalist-line-border",2,"width","100%","margin","20px 0px 20px 0px"],[1,"text-truncate",2,"width","15px"],[1,"text-truncate"],[4,"ngIf"],[4,"ngFor","ngForOf"],["popupWorkModal",""],["src","../../../../assets/img/loading.gif","width","25px"],["colspan","9",2,"text-align","center"],[1,"text-danger"],["href","javascript:;",1,"text-danger",3,"routerLink"],[1,"customers","d-inline-block","avatar-group"],["class","d-inline-block",4,"ngFor","ngForOf"],[1,"text-truncate",2,"cursor","pointer",3,"click"],[1,"fa","fa-bell-o",2,"font-size","14pt",3,"ngbTooltip"],[1,"badge-pill","badge-danger"],["class","badge badge-warning",4,"ngIf"],["class","badge badge-success",4,"ngIf"],["class","badge badge-danger",4,"ngIf"],[1,"d-inline-block"],[1,"img-40","rounded-circle",3,"src","alt","ngbTooltip"],["src","../../../../assets/img/icon.png",1,"img-40","rounded-circle",3,"alt","ngbTooltip"],[1,"badge","badge-warning"],[1,"badge","badge-success"],[1,"badge","badge-danger"],[1,"btn","btn-sm","btn-warning","mr-sm-1",3,"ngbTooltip","click"],[1,"icofont","icofont-pencil-alt-5"],["class","btn btn-sm btn-danger mr-sm-1",3,"ngbTooltip","click",4,"ngIf"],[1,"btn","btn-sm","btn-danger","mr-sm-1",3,"ngbTooltip","click"],[1,"fa","fa-trash"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-group"],[1,"col-md-12"],["for","title"],["type","text","name","title","id","title","autocomplete","off","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","description"],["id","description","rows","3","name","description","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],["for","assignedto"],[1,"text-danger","mr-sm-2"],["href","javascript:;","class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["name","_users","bindValue","id","required","",3,"items","multiple","closeOnSelect","searchable","bindLabel","ngModel","placeholder","notFoundText","disabled","ngModelChange","change"],["class","col-md-12",4,"ngIf"],["for","validdate"],["type","text","name","jdate","bsDatepicker","","autocomplete","off","required","",1,"form-control",3,"placeholder","ngModel","bsConfig","disabled","ngModelChange","bsValueChange"],["for","taskrelative"],["name","taskrelative","nzShowSearch","","nzCheckable","",2,"width","100%",3,"ngModel","nzNodes","nzPlaceHolder","disabled","nzNotFoundContent","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-light",3,"click"],["href","javascript:;",1,"btn","btn-sm","btn-primary",3,"click"],["for","follower"],["name","_usersCc","bindValue","id","required","",3,"items","multiple","closeOnSelect","searchable","bindLabel","ngModel","placeholder","notFoundText","disabled","ngModelChange"],["href","javascript:;",1,"btn","btn-primary","mr-sm-1"],["src","../../../../assets/img/loading.gif","width","15px"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){if(1&t){const t=y.EpF();y.TgZ(0,"div",0),y.TgZ(1,"div",1),y.TgZ(2,"div",2),y.TgZ(3,"div",3),y.TgZ(4,"div",4),y.TgZ(5,"div",1),y.TgZ(6,"div",5),y.TgZ(7,"div",6),y.TgZ(8,"input",7),y.NdJ("ngModelChange",function(t){return e._keyword=t})("change",function(){return e.loadData()})("keyup.enter",function(){return e.loadData()}),y.ALo(9,"translate"),y.qZA(),y.TgZ(10,"button",8),y.NdJ("click",function(){y.CHM(t);const i=y.MAs(81);return e._openModal(i,null)}),y._uU(11),y.ALo(12,"translate"),y.qZA(),y.YNc(13,qt,1,0,"img",9),y.qZA(),y.qZA(),y.TgZ(14,"div",10),y.TgZ(15,"div",11),y.TgZ(16,"select",12),y.NdJ("ngModelChange",function(t){return e.pageSize=t})("change",function(t){return e._pageSizeChange(t)}),y.TgZ(17,"option",13),y._uU(18,"#10"),y.qZA(),y.TgZ(19,"option",14),y._uU(20,"#25"),y.qZA(),y.TgZ(21,"option",15),y._uU(22,"#50"),y.qZA(),y.TgZ(23,"option",16),y._uU(24,"#100"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(25,"div",17),y.TgZ(26,"div",18),y.TgZ(27,"div",19),y.TgZ(28,"div",20),y.TgZ(29,"pagination",21),y.NdJ("ngModelChange",function(t){return e.pageIndex=t})("pageChanged",function(t){return e.pageChanged(t)}),y.qZA(),y.qZA(),y.TgZ(30,"div",22),y.TgZ(31,"a",23),y._uU(32),y.ALo(33,"translate"),y.ALo(34,"translate"),y.ALo(35,"translate"),y.ALo(36,"translate"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.TgZ(37,"div",24),y.TgZ(38,"table",25),y.TgZ(39,"thead"),y.TgZ(40,"th",26),y._uU(41,"#"),y.qZA(),y.TgZ(42,"th",27),y._uU(43),y.ALo(44,"translate"),y.qZA(),y.TgZ(45,"th",27),y._uU(46),y.ALo(47,"translate"),y.qZA(),y.TgZ(48,"th",27),y._uU(49),y.ALo(50,"translate"),y.qZA(),y.TgZ(51,"th",27),y._uU(52),y.ALo(53,"translate"),y.qZA(),y.TgZ(54,"th",27),y._uU(55),y.ALo(56,"translate"),y.qZA(),y.TgZ(57,"th",27),y._uU(58),y.ALo(59,"translate"),y.qZA(),y.TgZ(60,"th",27),y._uU(61),y.ALo(62,"translate"),y.qZA(),y.TgZ(63,"th",27),y._uU(64),y.ALo(65,"translate"),y.qZA(),y.qZA(),y.TgZ(66,"tbody"),y.YNc(67,St,6,3,"ng-container",28),y.YNc(68,Ot,30,20,"ng-container",29),y.qZA(),y.qZA(),y.qZA(),y.TgZ(69,"div",18),y.TgZ(70,"div",19),y.TgZ(71,"div",20),y.TgZ(72,"pagination",21),y.NdJ("ngModelChange",function(t){return e.pageIndex=t})("pageChanged",function(t){return e.pageChanged(t)}),y.qZA(),y.qZA(),y.TgZ(73,"div",22),y.TgZ(74,"a",23),y._uU(75),y.ALo(76,"translate"),y.ALo(77,"translate"),y.ALo(78,"translate"),y.ALo(79,"translate"),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.YNc(80,Gt,53,59,"ng-template",null,30,y.W1O)}2&t&&(y.xp6(8),y.Q6J("placeholder",y.lcZ(9,39,"Search"))("ngModel",e._keyword),y.xp6(3),y.hij(" ",y.lcZ(12,41,"Add new request")," "),y.xp6(2),y.Q6J("ngIf",e._isLoading),y.xp6(3),y.Q6J("ngModel",e.pageSize),y.xp6(13),y.Q6J("boundaryLinks",!0)("totalItems",e.totalRow)("ngModel",e.pageIndex)("maxSize",e.pageDisplay)("itemsPerPage",e.pageSize),y.xp6(3),y.Q0o("",y.lcZ(33,43,"Total of records"),": ",e.totalRow," - ",y.lcZ(34,45,"Page")," ",e.pageIndex," ",y.lcZ(35,47,"of")," ",e.totalPage," ",y.lcZ(36,49,"page"),""),y.xp6(11),y.Oqu(y.lcZ(44,51,"Title")),y.xp6(3),y.hij(" ",y.lcZ(47,53,"Valid date")," "),y.xp6(3),y.hij(" ",y.lcZ(50,55,"Assigned to")," "),y.xp6(3),y.hij(" ",y.lcZ(53,57,"Reminder")," "),y.xp6(3),y.hij(" ",y.lcZ(56,59,"Joined")," "),y.xp6(3),y.Oqu(y.lcZ(59,61,"Status")),y.xp6(3),y.Oqu(y.lcZ(62,63,"Time")),y.xp6(3),y.Oqu(y.lcZ(65,65,"Actions")),y.xp6(3),y.Q6J("ngIf",0==e._requestslist.length),y.xp6(1),y.Q6J("ngForOf",e._requestslist),y.xp6(4),y.Q6J("boundaryLinks",!0)("totalItems",e.totalRow)("ngModel",e.pageIndex)("maxSize",e.pageDisplay)("itemsPerPage",e.pageSize),y.xp6(3),y.Q0o("",y.lcZ(76,67,"Total of records"),": ",e.totalRow," - ",y.lcZ(77,69,"Page")," ",e.pageIndex," ",y.lcZ(78,71,"of")," ",e.totalPage," ",y.lcZ(79,73,"page"),""))},directives:[_.Fj,_.JJ,_.On,s.O5,_.EJ,_.YN,_.Kr,g.Qt,s.sg,m.yS,U._L,_.Q7,N.w9,h.Y5,h.Np,bt.zr],pipes:[D.X$,s.uU],styles:[""]}),t})(),data:{title:"Requests",breadcrumb:"Requests"}},{path:"requests/detail/:id",component:vt,data:{title:"Details",breadcrumb:"Details"}}]}];let Pt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({imports:[[m.Bz.forChild(jt)],m.Bz]}),t})();var Ht=i(25689),Bt=i(72808),zt=i(36845),$t=i(16417),Kt=i(45593),Vt=i(3621);let Xt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=y.oAB({type:t}),t.\u0275inj=y.cJS({providers:[o.e,a.D,l.C,n.x,D.sK,w.p],imports:[[s.ez,Pt,_.u5,Z.JX,f.m9,D.aw,p.mr,h.kn.forRoot(),g.u3.forRoot(),u.f.forRoot(),d.zk.forRoot(),$t.xc,c.P4,r.F5,Ht.kW,U.IJ,N.A0,Bt.yI.forRoot(),zt.Xd,Kt.s8,C.d,bt.cq,Vt.xC]]}),t})()},59543:function(t,e,i){i.d(e,{p:function(){return n}});var s=i(37716);let n=(()=>{class t{transform(t){return this.localeString(t)}missingOneDecimalCheck(t){const e=(t+="").split(",")[1];return!(!e||1!==e.length)}missingAllDecimalsCheck(t){return!(t+="").split(",")[1]}missingOneDecimalCheck1(t){const e=(t+="").split(".")[1];return!(!e||1!==e.length)}missingAllDecimalsCheck1(t){return!(t+="").split(".")[1]}localeString(t){if(""===t)return"";let e,i,s,n,l,a;for(e=(t+="").split(","),i=e[0],s=e.length>1?"."+e[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");if(-1!==i.indexOf("."))l=i.slice(i.lastIndexOf(".")).replace(/\,/g,""),a=i.split("."),e=a[0]+l;else{if(e=i+s,this.missingOneDecimalCheck(e))return e+"0";if(this.missingAllDecimalsCheck(e))return e+""}return e}localeStringEn(t){if(""===t)return"";let e,i,s,n,l,a;for(e=(t+="").split(","),i=e[0],s=e.length>1?"."+e[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");if(-1!==i.indexOf("."))l=i.slice(i.lastIndexOf(".")).replace(/\,/g,""),a=i.split("."),e=a[0]+l;else{if(e=i+s,this.missingOneDecimalCheck(e))return e+"0";if(this.missingAllDecimalsCheck(e))return e+".00"}return e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=s.Yjl({name:"numberFormat",type:t,pure:!0}),t})()}}]);